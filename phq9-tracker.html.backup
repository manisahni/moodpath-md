<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Primary Meta Tags -->
    <title>PHQ-9 Depression Tracker - Anonymous Mood Monitoring | MoodPath MD</title>
    <meta name="title" content="PHQ-9 Depression Tracker - Anonymous Mood Monitoring | MoodPath MD">
    <meta name="description" content="Track your depression symptoms anonymously with the validated PHQ-9 questionnaire. Monitor your mood over time and share results with your healthcare provider.">
    <meta name="keywords" content="PHQ-9 tracker, depression symptoms, mood tracking, depression questionnaire, mental health monitoring, anonymous depression test">
    <meta name="author" content="MoodPath MD">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://manisahni.github.io/moodpath-md/phq9-tracker.html">
    <meta property="og:title" content="PHQ-9 Depression Tracker - Anonymous Mood Monitoring">
    <meta property="og:description" content="Track your depression symptoms anonymously with the validated PHQ-9 questionnaire. Monitor your mood over time and share results with your healthcare provider.">
    <meta property="og:image" content="https://manisahni.github.io/moodpath-md/assets/images/moodpath-md-phq9-og.jpg">
    <meta property="og:site_name" content="MoodPath MD">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://manisahni.github.io/moodpath-md/phq9-tracker.html">
    <meta property="twitter:title" content="PHQ-9 Depression Tracker - Anonymous Mood Monitoring">
    <meta property="twitter:description" content="Track your depression symptoms anonymously with the validated PHQ-9 questionnaire. Monitor your mood over time and share results with your healthcare provider.">
    <meta property="twitter:image" content="https://manisahni.github.io/moodpath-md/assets/images/moodpath-md-phq9-og.jpg">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://manisahni.github.io/moodpath-md/phq9-tracker.html">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "PHQ-9 Depression Tracker",
        "description": "Anonymous depression symptom tracking using the validated PHQ-9 questionnaire",
        "url": "https://manisahni.github.io/moodpath-md/phq9-tracker.html",
        "applicationCategory": "HealthApplication",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD",
            "description": "Free anonymous PHQ-9 tracking"
        },
        "provider": {
            "@type": "MedicalBusiness",
            "name": "MoodPath MD",
            "medicalSpecialty": "Psychiatry"
        }
    }
    </script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/clinical-warmth.css?v=3">
    <style>
        /* PHQ-9 Tracker Specific Styles */
        .tracker-hero {
            background: var(--gradient-primary);
            color: white;
            text-align: center;
            padding: 4rem 0;
            position: relative;
        }
        
        .tracker-hero h1 {
            color: white;
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        
        .tracker-hero p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.125rem;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .tracker-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 3rem 2rem;
        }
        
        .tracker-card {
            background: white;
            border-radius: 16px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 32px rgba(44, 95, 124, 0.1);
            border: 1px solid rgba(44, 95, 124, 0.08);
        }
        
        .phq9-question {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: rgba(44, 95, 124, 0.02);
            border-radius: 12px;
            border: 1px solid rgba(44, 95, 124, 0.06);
        }
        
        .question-text {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--ocean-blue);
            margin-bottom: 1rem;
        }
        
        .question-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.75rem;
        }
        
        .option-card {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem;
            border: 2px solid rgba(44, 95, 124, 0.1);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: white;
        }
        
        .option-card:hover {
            border-color: var(--ocean-blue);
            background: rgba(44, 95, 124, 0.02);
        }
        
        .option-card.selected {
            border-color: var(--ocean-blue);
            background: rgba(44, 95, 124, 0.05);
        }
        
        .option-card input[type="radio"] {
            margin: 0;
            transform: scale(1.2);
            accent-color: var(--ocean-blue);
        }
        
        .option-card label {
            margin: 0;
            font-weight: 500;
            color: var(--charcoal);
            cursor: pointer;
            flex: 1;
        }
        
        .option-card.selected label {
            color: var(--ocean-blue);
            font-weight: 600;
        }
        
        .score-display {
            background: linear-gradient(135deg, rgba(123, 160, 152, 0.1) 0%, rgba(44, 95, 124, 0.05) 100%);
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .score-number {
            font-size: 3rem;
            font-weight: 700;
            color: var(--ocean-blue);
            margin-bottom: 0.5rem;
        }
        
        .score-label {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--charcoal);
            margin-bottom: 0.5rem;
        }
        
        .score-description {
            color: var(--warm-gray);
            margin-bottom: 1rem;
        }
        
        .score-severity {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.875rem;
        }
        
        .severity-minimal {
            background: #dcfce7;
            color: #166534;
        }
        
        .severity-mild {
            background: #fef3c7;
            color: #92400e;
        }
        
        .severity-moderate {
            background: #fed7aa;
            color: #c2410c;
        }
        
        .severity-moderately-severe {
            background: #fecaca;
            color: #991b1b;
        }
        
        .severity-severe {
            background: #fecaca;
            color: #7f1d1d;
        }
        
        .history-section {
            margin-top: 3rem;
        }
        
        .history-chart {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 16px rgba(44, 95, 124, 0.1);
        }
        
        .chart-container {
            height: 300px;
            position: relative;
            margin: 2rem 0;
        }
        
        .chart-line {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--ocean-blue);
            opacity: 0.3;
        }
        
        .chart-point {
            position: absolute;
            width: 12px;
            height: 12px;
            background: var(--ocean-blue);
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 2px 8px rgba(44, 95, 124, 0.2);
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .chart-point:hover {
            transform: scale(1.2);
            box-shadow: 0 4px 12px rgba(44, 95, 124, 0.3);
        }
        
        .chart-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 1rem;
            font-size: 0.875rem;
            color: var(--warm-gray);
        }
        
        .history-list {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid rgba(44, 95, 124, 0.1);
            transition: background 0.2s ease;
        }
        
        .history-item:hover {
            background: rgba(44, 95, 124, 0.02);
        }
        
        .history-date {
            font-weight: 600;
            color: var(--charcoal);
        }
        
        .history-score {
            font-weight: 700;
            color: var(--ocean-blue);
        }
        
        .history-severity {
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .insights-section {
            background: linear-gradient(135deg, rgba(123, 160, 152, 0.05) 0%, rgba(44, 95, 124, 0.02) 100%);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .insight-card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            box-shadow: 0 2px 8px rgba(44, 95, 124, 0.1);
        }
        
        .insight-title {
            font-weight: 600;
            color: var(--ocean-blue);
            margin-bottom: 0.5rem;
        }
        
        .insight-text {
            color: var(--warm-gray);
            line-height: 1.6;
        }
        
        .action-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 2rem;
        }
        
        .btn-secondary {
            background: var(--ocean-blue);
            color: white;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-secondary:hover {
            background: var(--ocean-blue-dark);
            transform: translateY(-2px);
        }
        
        .btn-outline {
            background: transparent;
            color: var(--ocean-blue);
            border: 2px solid var(--ocean-blue);
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-outline:hover {
            background: var(--ocean-blue);
            color: white;
        }
        
        .privacy-note {
            background: rgba(44, 95, 124, 0.05);
            border: 1px solid rgba(44, 95, 124, 0.1);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 2rem;
            text-align: center;
            font-size: 0.875rem;
            color: var(--warm-gray);
        }
        
        .privacy-note strong {
            color: var(--ocean-blue);
        }
        
        @media (max-width: 768px) {
            .tracker-hero h1 {
                font-size: 2rem;
            }
            
            .tracker-container {
                padding: 2rem 1rem;
            }
            
            .tracker-card {
                padding: 1.5rem;
            }
            
            .question-options {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="nav-wrapper">
                <div class="logo">
                    <svg width="36" height="36" viewBox="0 0 40 40">
                        <circle cx="20" cy="20" r="18" fill="none" stroke="#2C5F7C" stroke-width="1.5"/>
                        <path d="M20 10 Q25 20, 20 30 Q15 20, 20 10" fill="#7BA098" opacity="0.3"/>
                        <circle cx="20" cy="20" r="3" fill="#2C5F7C"/>
                    </svg>
                    <span class="logo-text">MoodPath MD</span>
                </div>
                <ul class="nav-menu">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="about.html">About</a></li>
                    <li><a href="faq.html">FAQ</a></li>
                    <li><a href="resources.html">Resources</a></li>
                    <li><a href="screening.html" class="btn btn-primary" style="background: #2C5F7C !important; color: white !important; font-weight: 700 !important; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.15) !important;">Get Started</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <section class="tracker-hero">
        <div class="container">
            <h1>PHQ-9 Depression Tracker</h1>
            <p>Monitor your depression symptoms anonymously over time. Share results with your healthcare provider to track your progress.</p>
        </div>
    </section>

    <div class="container">
        <div class="tracker-container">
            <!-- Current Assessment -->
            <div class="tracker-card" id="assessment-section">
                <h2 style="color: var(--ocean-blue); margin-bottom: 1.5rem;">Today's Assessment</h2>
                <p style="color: var(--warm-gray); margin-bottom: 2rem;">
                    Over the last 2 weeks, how often have you been bothered by any of the following problems?
                </p>
                
                <form id="phq9-form">
                    <div class="phq9-question">
                        <div class="question-text">1. Little interest or pleasure in doing things</div>
                        <div class="question-options">
                            <div class="option-card">
                                <input type="radio" name="q1" value="0" id="q1-0">
                                <label for="q1-0">Not at all</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q1" value="1" id="q1-1">
                                <label for="q1-1">Several days</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q1" value="2" id="q1-2">
                                <label for="q1-2">More than half the days</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q1" value="3" id="q1-3">
                                <label for="q1-3">Nearly every day</label>
                            </div>
                        </div>
                    </div>

                    <div class="phq9-question">
                        <div class="question-text">2. Feeling down, depressed, or hopeless</div>
                        <div class="question-options">
                            <div class="option-card">
                                <input type="radio" name="q2" value="0" id="q2-0">
                                <label for="q2-0">Not at all</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q2" value="1" id="q2-1">
                                <label for="q2-1">Several days</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q2" value="2" id="q2-2">
                                <label for="q2-2">More than half the days</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q2" value="3" id="q2-3">
                                <label for="q2-3">Nearly every day</label>
                            </div>
                        </div>
                    </div>

                    <div class="phq9-question">
                        <div class="question-text">3. Trouble falling or staying asleep, or sleeping too much</div>
                        <div class="question-options">
                            <div class="option-card">
                                <input type="radio" name="q3" value="0" id="q3-0">
                                <label for="q3-0">Not at all</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q3" value="1" id="q3-1">
                                <label for="q3-1">Several days</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q3" value="2" id="q3-2">
                                <label for="q3-2">More than half the days</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q3" value="3" id="q3-3">
                                <label for="q3-3">Nearly every day</label>
                            </div>
                        </div>
                    </div>

                    <div class="phq9-question">
                        <div class="question-text">4. Feeling tired or having little energy</div>
                        <div class="question-options">
                            <div class="option-card">
                                <input type="radio" name="q4" value="0" id="q4-0">
                                <label for="q4-0">Not at all</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q4" value="1" id="q4-1">
                                <label for="q4-1">Several days</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q4" value="2" id="q4-2">
                                <label for="q4-2">More than half the days</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q4" value="3" id="q4-3">
                                <label for="q4-3">Nearly every day</label>
                            </div>
                        </div>
                    </div>

                    <div class="phq9-question">
                        <div class="question-text">5. Poor appetite or overeating</div>
                        <div class="question-options">
                            <div class="option-card">
                                <input type="radio" name="q5" value="0" id="q5-0">
                                <label for="q5-0">Not at all</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q5" value="1" id="q5-1">
                                <label for="q5-1">Several days</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q5" value="2" id="q5-2">
                                <label for="q5-2">More than half the days</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q5" value="3" id="q5-3">
                                <label for="q5-3">Nearly every day</label>
                            </div>
                        </div>
                    </div>

                    <div class="phq9-question">
                        <div class="question-text">6. Feeling bad about yourself - or that you are a failure or have let yourself or your family down</div>
                        <div class="question-options">
                            <div class="option-card">
                                <input type="radio" name="q6" value="0" id="q6-0">
                                <label for="q6-0">Not at all</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q6" value="1" id="q6-1">
                                <label for="q6-1">Several days</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q6" value="2" id="q6-2">
                                <label for="q6-2">More than half the days</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q6" value="3" id="q6-3">
                                <label for="q6-3">Nearly every day</label>
                            </div>
                        </div>
                    </div>

                    <div class="phq9-question">
                        <div class="question-text">7. Trouble concentrating on things, such as reading the newspaper or watching television</div>
                        <div class="question-options">
                            <div class="option-card">
                                <input type="radio" name="q7" value="0" id="q7-0">
                                <label for="q7-0">Not at all</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q7" value="1" id="q7-1">
                                <label for="q7-1">Several days</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q7" value="2" id="q7-2">
                                <label for="q7-2">More than half the days</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q7" value="3" id="q7-3">
                                <label for="q7-3">Nearly every day</label>
                            </div>
                        </div>
                    </div>

                    <div class="phq9-question">
                        <div class="question-text">8. Moving or speaking slowly enough that other people could have noticed. Or the opposite - being so fidgety or restless that you have been moving around a lot more than usual</div>
                        <div class="question-options">
                            <div class="option-card">
                                <input type="radio" name="q8" value="0" id="q8-0">
                                <label for="q8-0">Not at all</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q8" value="1" id="q8-1">
                                <label for="q8-1">Several days</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q8" value="2" id="q8-2">
                                <label for="q8-2">More than half the days</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q8" value="3" id="q8-3">
                                <label for="q8-3">Nearly every day</label>
                            </div>
                        </div>
                    </div>

                    <div class="phq9-question">
                        <div class="question-text">9. Thoughts that you would be better off dead or of hurting yourself in some way</div>
                        <div class="question-options">
                            <div class="option-card">
                                <input type="radio" name="q9" value="0" id="q9-0">
                                <label for="q9-0">Not at all</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q9" value="1" id="q9-1">
                                <label for="q9-1">Several days</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q9" value="2" id="q9-2">
                                <label for="q9-2">More than half the days</label>
                            </div>
                            <div class="option-card">
                                <input type="radio" name="q9" value="3" id="q9-3">
                                <label for="q9-3">Nearly every day</label>
                            </div>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 2rem;">
                        <button type="submit" class="btn btn-primary" style="padding: 1rem 2rem; font-size: 1.125rem;">
                            Calculate My Score
                        </button>
                    </div>
                </form>
            </div>

            <!-- Results Section -->
            <div class="tracker-card" id="results-section" style="display: none;">
                <h2 style="color: var(--ocean-blue); margin-bottom: 1.5rem;">Your PHQ-9 Results</h2>
                
                <div class="score-display">
                    <div class="score-number" id="score-number">0</div>
                    <div class="score-label" id="score-label">Minimal Depression</div>
                    <div class="score-description" id="score-description">Your symptoms are within normal range.</div>
                    <div class="score-severity" id="score-severity">Minimal</div>
                </div>

                <div class="insights-section">
                    <h3 style="color: var(--ocean-blue); margin-bottom: 1rem;">What This Means</h3>
                    
                    <div class="insight-card">
                        <div class="insight-title">📊 Understanding Your Score</div>
                        <div class="insight-text" id="score-explanation">
                            PHQ-9 scores range from 0-27. Higher scores indicate more severe depression symptoms.
                        </div>
                    </div>
                    
                    <div class="insight-card">
                        <div class="insight-title">📈 Tracking Progress</div>
                        <div class="insight-text">
                            Regular PHQ-9 assessments help you and your healthcare provider monitor treatment effectiveness and adjust care as needed.
                        </div>
                    </div>
                    
                    <div class="insight-card">
                        <div class="insight-title">🔒 Privacy & Security</div>
                        <div class="insight-text">
                            Your responses are stored locally in your browser. No personal information is collected or transmitted.
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn-secondary" onclick="saveResult()">
                        💾 Save This Result
                    </button>
                    <button class="btn-outline" onclick="showHistory()">
                        📊 View History
                    </button>
                    <button class="btn-outline" onclick="resetForm()">
                        🔄 Take New Assessment
                    </button>
                    <a href="screening.html" class="btn-secondary">
                        🏥 Get Professional Help
                    </a>
                </div>
            </div>

            <!-- History Section -->
            <div class="tracker-card" id="history-section" style="display: none;">
                <h2 style="color: var(--ocean-blue); margin-bottom: 1.5rem;">Your Tracking History</h2>
                
                <div class="history-chart">
                    <h3 style="margin-bottom: 1rem;">Progress Over Time</h3>
                    <div class="chart-container" id="chart-container">
                        <div class="chart-line"></div>
                        <!-- Chart points will be generated here -->
                    </div>
                    <div class="chart-labels">
                        <span>Older</span>
                        <span>Recent</span>
                    </div>
                </div>

                <div class="history-list" id="history-list">
                    <!-- History items will be generated here -->
                </div>

                <div style="text-align: center; margin-top: 2rem;">
                    <button class="btn-outline" onclick="clearHistory()">
                        🗑️ Clear All History
                    </button>
                    <button class="btn-secondary" onclick="exportHistory()">
                        📄 Export Results
                    </button>
                </div>
            </div>

            <div class="privacy-note">
                <strong>🔒 Your Privacy Matters</strong><br>
                All data is stored locally in your browser. No personal information is collected, transmitted, or stored on our servers.
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <div class="emergency-note">
                <strong>If you're in crisis:</strong> Please call 988 for immediate support.
            </div>
            <p>&copy; 2024 MoodPath MD. Board-certified • State licensed • HIPAA compliant</p>
            <p style="margin-top: 1rem; font-size: 0.875rem; opacity: 0.7;">
                Not for emergencies. Telehealth has limitations. Results vary.
            </p>
        </div>
    </footer>

    <script>
        // ================================================
        // PHQ-9 TRACKER - ANONYMOUS MOOD MONITORING
        // ================================================

        class PHQ9Tracker {
            constructor() {
                this.form = document.getElementById('phq9-form');
                this.resultsSection = document.getElementById('results-section');
                this.historySection = document.getElementById('history-section');
                this.assessmentSection = document.getElementById('assessment-section');
                this.init();
            }
            
            init() {
                this.form.addEventListener('submit', (e) => this.handleSubmit(e));
                this.setupOptionCards();
                this.loadHistory();
            }
            
            setupOptionCards() {
                const optionCards = document.querySelectorAll('.option-card');
                optionCards.forEach(card => {
                    const radio = card.querySelector('input[type="radio"]');
                    const label = card.querySelector('label');
                    
                    // Handle card clicks
                    card.addEventListener('click', () => {
                        radio.checked = true;
                        this.updateCardSelection();
                    });
                    
                    // Handle radio changes
                    radio.addEventListener('change', () => {
                        this.updateCardSelection();
                    });
                });
            }
            
            updateCardSelection() {
                const optionCards = document.querySelectorAll('.option-card');
                optionCards.forEach(card => {
                    const radio = card.querySelector('input[type="radio"]');
                    if (radio.checked) {
                        card.classList.add('selected');
                    } else {
                        card.classList.remove('selected');
                    }
                });
            }
            
            handleSubmit(e) {
                e.preventDefault();
                
                const formData = new FormData(this.form);
                let totalScore = 0;
                let allAnswered = true;
                
                // Calculate total score
                for (let i = 1; i <= 9; i++) {
                    const value = formData.get(`q${i}`);
                    if (value === null) {
                        allAnswered = false;
                        break;
                    }
                    totalScore += parseInt(value);
                }
                
                if (!allAnswered) {
                    alert('Please answer all questions to get your PHQ-9 score.');
                    return;
                }
                
                this.displayResults(totalScore);
            }
            
            displayResults(score) {
                const scoreNumber = document.getElementById('score-number');
                const scoreLabel = document.getElementById('score-label');
                const scoreDescription = document.getElementById('score-description');
                const scoreSeverity = document.getElementById('score-severity');
                const scoreExplanation = document.getElementById('score-explanation');
                
                scoreNumber.textContent = score;
                
                let label, description, severity, explanation;
                
                if (score <= 4) {
                    label = 'Minimal Depression';
                    description = 'Your symptoms are within normal range.';
                    severity = 'Minimal';
                    explanation = 'Your PHQ-9 score indicates minimal depression symptoms. This is considered normal mood variation.';
                } else if (score <= 9) {
                    label = 'Mild Depression';
                    description = 'You may have mild depression. Consider monitoring your symptoms.';
                    severity = 'Mild';
                    explanation = 'Your score suggests mild depression. Consider lifestyle changes, therapy, or consulting a healthcare provider if symptoms persist.';
                } else if (score <= 14) {
                    label = 'Moderate Depression';
                    description = 'You have moderate depression symptoms. Professional help is recommended.';
                    severity = 'Moderate';
                    explanation = 'Your score indicates moderate depression. Professional treatment is recommended. Consider reaching out to a mental health provider.';
                } else if (score <= 19) {
                    label = 'Moderately Severe Depression';
                    description = 'You have moderately severe depression. Professional treatment is strongly recommended.';
                    severity = 'Moderately Severe';
                    explanation = 'Your score suggests moderately severe depression. Professional treatment is strongly recommended. Please consider seeking help soon.';
                } else {
                    label = 'Severe Depression';
                    description = 'You have severe depression. Immediate professional help is needed.';
                    severity = 'Severe';
                    explanation = 'Your score indicates severe depression. Immediate professional help is needed. Please contact a mental health provider or call 988 for crisis support.';
                }
                
                scoreLabel.textContent = label;
                scoreDescription.textContent = description;
                scoreSeverity.textContent = severity;
                scoreExplanation.textContent = explanation;
                
                // Update severity class
                scoreSeverity.className = `score-severity severity-${severity.toLowerCase().replace(' ', '-')}`;
                
                this.assessmentSection.style.display = 'none';
                this.resultsSection.style.display = 'block';
                this.historySection.style.display = 'none';
            }
            
            saveResult() {
                const score = parseInt(document.getElementById('score-number').textContent);
                const label = document.getElementById('score-label').textContent;
                const date = new Date().toISOString();
                
                const result = {
                    score: score,
                    label: label,
                    date: date,
                    timestamp: Date.now()
                };
                
                this.addToHistory(result);
                alert('Result saved! You can view your history anytime.');
            }
            
            addToHistory(result) {
                let history = this.getHistory();
                history.push(result);
                
                // Keep only last 30 entries
                if (history.length > 30) {
                    history = history.slice(-30);
                }
                
                localStorage.setItem('phq9_history', JSON.stringify(history));
            }
            
            getHistory() {
                const history = localStorage.getItem('phq9_history');
                return history ? JSON.parse(history) : [];
            }
            
            loadHistory() {
                const history = this.getHistory();
                if (history.length > 0) {
                    this.updateHistoryDisplay(history);
                }
            }
            
            updateHistoryDisplay(history) {
                const historyList = document.getElementById('history-list');
                const chartContainer = document.getElementById('chart-container');
                
                // Clear existing content
                historyList.innerHTML = '';
                chartContainer.innerHTML = '<div class="chart-line"></div>';
                
                // Sort by date (newest first)
                const sortedHistory = [...history].sort((a, b) => b.timestamp - a.timestamp);
                
                // Create history list
                sortedHistory.forEach((entry, index) => {
                    const item = document.createElement('div');
                    item.className = 'history-item';
                    
                    const date = new Date(entry.date).toLocaleDateString();
                    const severityClass = `severity-${entry.label.toLowerCase().replace(' ', '-')}`;
                    
                    item.innerHTML = `
                        <div class="history-date">${date}</div>
                        <div class="history-score">${entry.score}</div>
                        <div class="history-severity ${severityClass}">${entry.label}</div>
                    `;
                    
                    historyList.appendChild(item);
                });
                
                // Create chart
                if (sortedHistory.length > 1) {
                    const chartData = sortedHistory.reverse(); // Oldest to newest for chart
                    const maxScore = Math.max(...chartData.map(d => d.score));
                    const chartHeight = 280; // Account for padding
                    const chartWidth = chartContainer.offsetWidth - 40; // Account for padding
                    
                    chartData.forEach((entry, index) => {
                        const x = (index / (chartData.length - 1)) * chartWidth + 20;
                        const y = chartHeight - (entry.score / maxScore) * chartHeight + 20;
                        
                        const point = document.createElement('div');
                        point.className = 'chart-point';
                        point.style.left = `${x}px`;
                        point.style.bottom = `${y}px`;
                        point.title = `${new Date(entry.date).toLocaleDateString()}: ${entry.score}`;
                        
                        chartContainer.appendChild(point);
                    });
                }
            }
            
            showHistory() {
                this.assessmentSection.style.display = 'none';
                this.resultsSection.style.display = 'none';
                this.historySection.style.display = 'block';
                
                const history = this.getHistory();
                this.updateHistoryDisplay(history);
            }
            
            resetForm() {
                this.form.reset();
                this.updateCardSelection();
                this.assessmentSection.style.display = 'block';
                this.resultsSection.style.display = 'none';
                this.historySection.style.display = 'none';
            }
            
            clearHistory() {
                if (confirm('Are you sure you want to clear all your tracking history? This cannot be undone.')) {
                    localStorage.removeItem('phq9_history');
                    this.updateHistoryDisplay([]);
                    alert('History cleared.');
                }
            }
            
            exportHistory() {
                const history = this.getHistory();
                if (history.length === 0) {
                    alert('No history to export.');
                    return;
                }
                
                const csvContent = this.convertToCSV(history);
                const blob = new Blob([csvContent], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `phq9-history-${new Date().toISOString().split('T')[0]}.csv`;
                a.click();
                window.URL.revokeObjectURL(url);
            }
            
            convertToCSV(history) {
                const headers = ['Date', 'Score', 'Severity'];
                const rows = history.map(entry => [
                    new Date(entry.date).toLocaleDateString(),
                    entry.score,
                    entry.label
                ]);
                
                return [headers, ...rows].map(row => row.join(',')).join('\n');
            }
        }

        // Global functions for button clicks
        function saveResult() {
            tracker.saveResult();
        }
        
        function showHistory() {
            tracker.showHistory();
        }
        
        function resetForm() {
            tracker.resetForm();
        }
        
        function clearHistory() {
            tracker.clearHistory();
        }
        
        function exportHistory() {
            tracker.exportHistory();
        }

        // Initialize tracker
        let tracker;
        document.addEventListener('DOMContentLoaded', () => {
            tracker = new PHQ9Tracker();
        });
    </script>
</body>
</html>
